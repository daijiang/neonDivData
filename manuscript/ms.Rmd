---
title: "Tidy NEON organismal data for biodiversity research"
author: 
  - "Daijiang Li^1,2†‡^, Sydne Record^3†^, Eric Sokol^4,5†‡^, Matthew E. Bitters^6^, Melissa Y. Chen^6^, Anny Y. Chung^7^, Matthew R. Helmus^8^, Ruvi Jaimes^9^, Lara Jansen^10^, Marta A. Jarzyna^11,12^, Michael G. Just^13^, Jalene M. LaMontagne^14^, Brett Melbourne^6^, Wynne Moss^6^, Kari Norman^15^, Stephanie Parker^4^, Natalie Robinson^4^, Bijan Seyednasrollah^16^, Colin Smith^17^, Sarah Spaulding^5^, Thilina Surasinghe^18^, Sarah Thomsen^19^, Phoebe Zarnetske^20,21^"
date: '`r format(Sys.time(), "%d %B, %Y")`'
output:
 bookdown::html_document2:
  number_sections: no
  theme: readable
  toc: yes
  keep_md: yes
 bookdown::tufte_html2:
  number_sections: no
  toc: no
 bookdown::pdf_document2:
  includes:
   before_body: doc_prefix.tex
   in_header: preamble.tex
  keep_tex: yes
  latex_engine: xelatex
  number_sections: no
  toc: yes
 bookdown::word_document2:
  toc: no
  keep_md: yes
fontsize: 12pt
linestretch: 1.5
link-citations: yes
csl: https://raw.githubusercontent.com/citation-style-language/styles/master/ecology.csl
bibliography: ref.bib
always_allow_html: yes
links-as-notes: false
notes-after-punctuation: false
---

```{r knitr_options, include=FALSE}
# https://raw.githubusercontent.com/citation-style-language/styles/master/vancouver-superscript.csl
library(knitr)
opts_chunk$set(fig.align='center', cache = FALSE, warning = FALSE,
        message = FALSE, echo = FALSE, out.width = '95%')
options(digits = 3, width = 88)
tpl_1 = 'https://raw.githubusercontent.com/daijiang/workflow_demo/master/template/preamble.tex'
tpl_2 = 'https://raw.githubusercontent.com/daijiang/workflow_demo/master/template/doc_prefix.tex'
# bib_1 = 'https://raw.githubusercontent.com/daijiang/workflow_demo/master/template/ref.bib'
if(!file.exists(tpl_1f <- 'preamble.tex')) download.file(tpl_1, tpl_1f)
if(!file.exists(tpl_2f <- 'doc_prefix.tex')) download.file(tpl_2, tpl_2f)
# if(!file.exists(bib_1f <- 'ref.bib')) download.file(bib_1, bib_1f)
root_path = "."
opts_knit$set(root.dir = normalizePath(root_path))
# suppressMessages(library(tidyverse))
# library(kableExtra)
options(knitr.graphics.auto_pdf = TRUE, knitr.kable.NA = '')
if(knitr::is_latex_output() | knitr::is_html_output()){
 library(kableExtra)
} else {
 options(kableExtra.auto_format = FALSE) # for docx
}
library(neonDivData)
library(dplyr)
library(stringr)
```

\footnotesize
^1^ Department of Biological Sciences, Louisiana State University, Baton Rouge, LA, United States  
^2^ Center for Computation & Technology, Louisiana State University, Baton Rouge, LA, United States  
^3^ Department of Biology, Bryn Mawr College, Bryn Mawr, PA, United States  
^4^ National Ecological Observatory Network (NEON), Battelle Memorial Institute, Boulder, CO, United States  
^5^ Institute of Arctic and Alpine Research (INSTAAR), University of Colorado Boulder, Boulder, CO, United States  
^6^ Department of Ecology and Evolutionary Biology, University of Colorado Boulder, Boulder, CO, United States  
^7^ Departments of Plant Biology and Plant Pathology, University of Georgia, Athens, GA, United States  
^8^ Integrative Ecology Lab, Center for Biodiversity, Department of Biology, Temple University, Philadelphia, PA, United States
^9^ St. Edward's University, Austin, Texas
^10^ Department of Environmental Science and Management, Portland State University, Portland, OR, United States  
^11^ Department of Evolution, Ecology and Organismal Biology, The Ohio State University, Columbus, OH, United States  
^12^ Translational Data Analytics Institute, The Ohio State University, Columbus, OH, United States  
^13^ Ecological Processes Branch, U.S. Army ERDC CERL, Champaign, IL, United States  
^14^ Department of Biological Sciences, DePaul University, Chicago, IL, United States  
^15^ Department of Environmental Science, Policy, and Management, University of California Berkeley, Berkeley, CA, United States  
^16^ School of Informatics, Computing and Cyber Systems, Northern Arizona University, Flagstaff, AZ, United States  
^17^ Environmental Data Initiative, University of Wisconsin-Madison, Madison, WI
^18^ Department of Biological Sciences, Bridgewater State University, Bridgewater, MA, United States  
^19^ Department of Integrative Biology, Oregon State University, Corvallis, OR, United States  
^20^ Department of Integrative Biology, Michigan State University, East Lansing, MI, United States  
^21^ Ecology, Evolution, and Behavior Program, Michigan State University, East Lansing, MI, United States
^†^ Equal contributions
^‡^ Corresponding authors

\normalsize

**Abstract**: Understanding patterns and drivers of species distributions and abundances, and thus biodiversity, is a core goal of ecology. Despite advances in recent decades, research into these patterns and processes is currently limited by a lack of standardized, high-quality, empirical data that spans large spatial scales and long time periods. The National Ecological Observatory Network (NEON) fills this gap by providing freely available observational data that are: generated during robust and consistent organismal sampling of several sentinel taxonomic groups within 81 sites distributed across the United States; available for at least 30 years. The breadth and scope of these data provides a unique resource for advancing biodiversity research. To maximize the potential of this opportunity, however, it is critical that NEON data be maximally accessible and easily integrated into investigators’ workflows and analyses. To facilitate its use for biodiversity research and synthesis, we created a workflows to process and format NEON organismal data into the ecocomDP (ecological community data design pattern) format, which we have made available in the `ecocomDP` R package; we then provided the standardized data as an R data package (`neonDivData`). We briefly summarize sampling designs and data wrangling decisions for the major taxonomic groups included in this effort. Our workflows are  open-source so the biodiversity community may: add additional taxonomic groups; modify the workflow to produce datasets appropriate for their own analytical needs; and regularly update the data packages as more observations become available. Finally, we provide two simple examples of how the standardized data may be used for biodiversity research. By providing a standardized data package, we hope to enhance the utility of NEON organismal data in advancing biodiversity research.

**Key words**: NEON, Biodiversity, Organismal Data, Data Product, R, Data package 

# Introduction (or why tidy NEON organismal data)

A central goal of ecology is to understand the patterns and processes of biodiversity, and this is particularly important in an era of rapid global environmental change [@midgley2005global; @blowes2019geography]. Such understanding is only possible through studies that address questions like: How is biodiversity distributed across large spatial scales, ranging from ecoregions to continents? What mechanisms drive spatial patterns of biodiversity? Are spatial patterns of biodiversity similar among different taxonomic groups, and if not, why do we see variation? How does community composition vary across spatial and environmental gradients? What are the local and landscape scale drivers of community structure? How and why do biodiversity patterns change over time? Answers to such questions will enable better management and conservation of biodiversity and ecosystem services. 

Biodiversity research has a long history [@worm2018theory], beginning with major scientific expeditions (e.g., Alexander von Humboldt, Charles Darwin) aiming to document global species lists after the establishment of Linnaeus's Systema Naturae [@linnaeus1758systema]. Beginning in the 1950’s [@curtis1959vegetation; @hutchinson1959homage], researchers moved beyond documentation to focus on quantifying patterns of species diversity and describing mechanisms underlying their heterogeneity. Since the beginning of this line of research major theoretical breakthroughs [@macarthur1967theory; @hubbell2001unified; @brown2004toward; @harte2011maximum] have advanced our understanding of potential mechanisms causing and maintaining biodiversity. Modern empirical studies, however, have been largely constrained to local or regional scales and focused on one or a few taxonomic groups, because of the considerable effort required to collect observational data. There are now unprecedented numbers of observations from independent small and short-term ecological studies. These data support research into generalities through syntheses and meta-analyses [@vellend2013global; @blowes2019geography; @li2020changes], but this work is challenged by the difficulty of integrating data from different studies and with varying limitations. Such limitations include: differing collection methods (methodological uncertainties); varying levels of statistical robustness; inconsistent handling of missing data; spatial bias; publication bias; and design flaws [@martin2012mapping; @nakagawa2012methodological; @koricheva2014uses; @welti2021meta]. Additionally, it has historically been challenging for researchers to obtain and collate data from a diversity of sources, for use in syntheses and/or meta-analyses [@gurevitch1999statistical]. 

Barriers to meta-analyses have been remedied in recent years by large efforts to digitize museum and herbarium specimens (e.g., iDigBio), successful community science programs (e.g., iNaturalist, eBird), technological advances (e.g., remote sensing, automated acoustic recorders), and long running coordinated research networks - which together bring biodiversity research into the big data era [@hampton2013big; @farley2018situating]. Yet, each of these comes with its own limitations. Museum/herbarium specimens and community science records are increasingly available, but are still incidental and unstructured in terms of the sampling design, and exhibit marked geographic and taxonomic biases [@martin2012mapping; @beck2014spatial; @geldmann2016determines]. Remote sensing approaches may cover large spatial scales, but may also be of low spatial resolution and unable to reliably penetrate vegetation canopy [@palumbo2017building; @g2019remote]. The standardized observational sampling of woody trees by the United States Forest Service’s Forest Inventory and Analysis and of birds by the United States Geological Survey’s Breeding Bird Survey have been ongoing across the United States since 2001 and 1966, respectively [@bechtold2005enhanced; @sauer2017first], but cover few taxonomic groups. And while the Long Term Ecological Research Network (LTER) consists of 28 sites that provide up to 40 years of observational and experimental datasets for a diverse set of ecosystems and taxa, there is no standardization in the design and data collections across sites [@jones2021synergies]. The same lack of standardized sampling is also true of the younger Critical Zone Observatory (CZO) [@jones2021synergies]. Thus, despite recent advances biodiversity research is still impeded by a lack of standardized, high quality, and open-access data spanning large spatial scales and long time periods. 

The recently established National Ecological Observatory Network (NEON) provides continental-scale observational and instrumentation data for a wide variety of taxonomic groups and measurement streams. Data are collected using standardized methods, across 81 field sites in both terrestrial and freshwater ecosystems, and will be freely available for at least 30 years. These consistently collected, long-term, and spatially robust measurements are directly comparable throughout the Observatory, and provide a unique opportunity for enabling a better understanding of ecosystem change and biodiversity patterns and processes across space and through time [@keller2008continental]. 

NEON data are designed to be maximally useful to ecologists by aligning with FAIR principles [findable, accessible, interoperable, and reusable @wilkinson2016fair]. Despite meeting these requirements, however, there are still challenges to integrating NEON organismal data for reproducible biodiversity research. For example: field names may vary across NEON data products, even for similar measurements; some measurements include sampling unit information, whereas units must be calculated for others; and data are in a raw form that often includes metadata unnecessary for biodiversity analyses. These issues and inconsistencies may be overcome through data cleaning and formatting, but understanding how best to perform this task requires a significant investment in the comprehensive NEON documentation for each data product involved in an analysis. Thoroughly reading large amounts of NEON documentation is time consuming, and the path to a standard data format, as is critical for reproducibility, may vary greatly between NEON organismal data products and users - even for similar analyses. Ultimately, this may result in subtle differences from study to study that hinder meta-analyses using NEON data. A simplified and standardized format for NEON organismal data would facilitate wider usage of these datasets for biodiversity research. Furthermore, if these data were formatted to interface well with datasets from other coordinated research networks, more comprehensive syntheses could be accomplished and to advance macrosystem biology [@record2020novel].  

One attractive standardized formatting style for NEON organismal data is that of ecocomDP (ecological community data design pattern, O’Brien et al. In review). ecocomDP is the brainchild of members of the LTER network, the Environmental Data Initiative (EDI), and NEON staff, and provides a model by which data from a variety of sources may be easily transformed into consistently formatted, analysis ready community-level organismal data packages. This is done using reproducible code that maintains different dataset “levels” as data move through the model. Here we apply the “dataset level” terminology relative to our workflow, such that L0 in incoming data, L1 represents an intermediate data format, and L2 is the output format. For the purposes of describing this workflow, the NEON L1 data products that serve as inputs to our pipeline are considered Level 0 (L0) data in our workflow. In our workflow, Level 1 (L1) data are L0 data transformed to the ecocomDP model and include tables representing observations, sampling locations, and taxonomic information (at a minimum). Finally, level 2 (L2) data represent data that have been further transformed for specific research studies. Thus far, >70 LTER organismal datasets have been harmonized to the L1 ecocomDP format  through the R package [`ecocomDP`](https://github.com/EDIorg/ecocomDP) and more datasets are in the queue for processing into the ecocomDP format by EDI. Note that the levels used here are different from those used by NEON to describe their data processing levels (https://www.neonscience.org/data-samples/data-management/data-processing). We refer to the input data streams provided by NEON as data products, whereas the cleaned and standardized collection of data files provided here as objects within an R data package, `neonDivDate`, across this paper.

Here, we briefly summarized NEON sampling designs for major taxonomic groups and major data wrangling decisions we made to simplify and standardize NEON data products following the ecocomDP format using the R package `ecocomDP`. All corresponding R code to process NEON data products were included in the R package `ecocomDP` for transparency and so future contributors may draw on this information in their work. To facilitate the distribution and usage of the standardized datasets, we deposited them in the EDI data portal (link) and provided them as an R data package [`neonDivData`](https://github.com/daijiang/neonDivData). Both of them will be maintained and updated as new data become available from the NEON portal. We hope this effort will substantially reduce data processing times for NEON data users and greatly facilitate the use of NEON organismal data to advance our understanding of Earth’s biodiversity. 

# Materials and Methods (or how to tidy NEON organismal data)

There are many details to consider when starting to use NEON organismal data products. Below we outline key points relevant to community-level biodiversity analyses with regards to the NEON Sampling Design and decisions that were made as the data products presented in this paper were converted into the ecocomDP data model. While the methodological sections below are specific to particular taxonomic groups, there are some general points that we came across while reviewing NEON data collection documentation and through discussion with NEON staff that apply to all NEON organismal data products. First, species occurrence and abundance measures as reported in NEON biodiversity data products are not standardized to sampling effort. Because there are often multiple approaches to cleaning (e.g., dealing with multiple levels of taxonomic resolution, interpretations of absences, etc.) and standardizing biodiversity survey data, NEON publishes raw observations along with sampling effort data to preserve as much information as possible so that data users can clean and standardize data as they see fit. The workflows described here for twelve taxonomic groups represented in eleven NEON data products produce standardized counts based on sampling effort, such as count of individuals per area sampled or count standardized to the duration of trap deployment, as described in Table \@ref(tab:dataMapping). The data wrangling workflows described below can be used to access, download, and clean data from the NEON Data Portal by using the R `ecocomDP` package. To view a catalog of available NEON data products in the ecocomDP format, use `ecocomDP::search_data(“NEON”)`. To import data from a given NEON data product into your R environment, use `ecocomDP::read_data()`, and set the `id` argument to the selected NEON to ecocomDP mapping workflow (the “L0 to L1 ecocomDP workflow ID” in Table \@ref(tab:dataMapping)). This will return a list of ecocomDP formatted tables and accompanying metadata. To create a flat data table (similar to the L2 data packages described below), use the `ecocomDP::flatten_ecocomDP()` function. Second, it should be noted that NEON data collection efforts will continue well after this paper is published and new changes to data collection methods and/or processing may vary over time. Such changes (e.g., change in the number of traps used for ground beetle collection) or interruptions (e.g., due to COVID-19) to data collection are documented in the Issues log for each data product on the NEON Data Portal as well as the Readme text file that is included with NEON data downloads.


(ref:Fig1DesignCap) Generalized sampling schematics for Terrestrial Observation System (A) and Aquatic Observation System (B-D) plots. For Terrestrial Observation System (TOS) plots, Distributed, Tower, and Gradient plots, and locations of various sampling regimes, are presented via symbols. For Aquatic Observation System (AOS) plots, Wadeable streams, Non-wadeable streams, and Lake plots are shown in detail, with locations of sensors and different sampling regimes presented using symbols. Panel A was originally published in @thorpe2016introduction.

```{r, Fig1Design, fig.cap="(ref:Fig1DesignCap)"}
include_graphics(here::here("manuscript/figures/fig_1.png"))
```

(ref:Table0MappingCap) Mapping NEON data products to ecocomDP formatted data packages with abundances _standardized_ to observation effort.

```{r dataMapping, echo=FALSE}
select(data_summary, `Taxon group` = taxon_group, 
       `L0 dataset (NEON L1 data product ID)` = original_neon_data_product_id,
       `L0 to L1 ecocomDP workflow ID` = neon_ecocomdp_mapping_method,
       `Primary variable reported in ecocomDP observation table` = variable_names,
       `Units` = units
       ) %>% 
  arrange(`Taxon group`) %>% 
  mutate(`Taxon group` = str_to_title(`Taxon group`)) %>%
  knitr::kable(caption = '(ref:Table0MappingCap)', booktab = T, 
       # align = "lrrrrrr", 
       linesep = "") %>%
 kableExtra::kable_styling(bootstrap_options = c("striped", "scale_down", "condensed", "hover"), 
              latex_options = c("striped", "scale_down"))
```
\*BIRD counts are reported per taxon per “cluster” observed in each point count in the NEON data product and have not been further standardized to sampling effort because standard methods for modeling bird abundances are beyond the scope of this paper.  
\*\*Incidence rate per number of tests conducted is reported for TICK_PATHOGENS.


## Terrestrial Organisms

### Breeding Land Birds

**NEON Sampling Design** NEON designates breeding landbirds as “smaller birds (usually exclusive of raptors and upland game birds) not usually associated with aquatic habitats'' [@ralph1993handbook]. Most species observed are diurnal and include both resident and migrant species. Landbirds are surveyed via point counts in each of the 47 terrestrial sites. At most NEON sites, breeding landbird points are located in five to ten 3 x 3 m grids (Fig. \@ref(fig:Fig1Design)), which are themselves located in representative (dominant) vegetation. Whenever possible, grid centers are co-located with distributed base plot centers. When sites are too small to support a minimum of five grids, separated by at least 250 m from edge to edge, point counts are completed at single points instead of grids. In these cases, points are located at the southwest corners of distributed base plots within the site. Five to 25 points may be surveyed depending on the size and spatial layout of the site, with exact point locations dictated by a stratified-random spatial design that maintains a 250 m minimum separation between points. 

Surveys occur during one or two sampling bouts per season, at large and small sites respectively. Observers go to the specified points early in the morning and track birds observed during each minute of a 6-minute period, following a 2-minute acclimation period, at each point. Each point count contains species, sex, and distance to each bird (measured with a laser rangefinder except in the case of flyovers) seen or heard. Information relevant for subsequent modeling of detectability is also collected during the point counts (e.g., weather, detection method). The point count surveys for NEON were modified from the Integrated Monitoring in Bird Conservation Regions (IMBCR) field protocol for spatially-balanced sampling of landbird populations [@pavlacky2017statistically].  

To protect species of concern, breeding landbird taxonomic IDs are ‘fuzzed’, whereby the data are provided with a taxonomic identification at one higher taxonomic level than where the protection occurs. For example, if a threatened Black-capped vireo (_Vireo atricapilla_) is recorded by a NEON technician, the taxonomic identification is fuzzed to Vireo in the data. Rare, threatened and endangered species are those listed as such by federal and/or state agencies.

**Data Wrangling Decisions** The bird point count data product (‘DP1.10003.001’) consists of a list of two associated data frames: `brd_countdata` and `brd_perpoint`. The former data frame contains information such as locations, species identities, and their counts. The latter data frame contains additional location information such as latitude and longitude coordinates and environmental conditions during the time of the observations. The separate data frames are linked by ‘eventID’, which refers to the location, date and time of the observation.To prepare the bird point count data for the L1 ecocomDP model, we first merged both data frames into one and then removed columns that are likely not needed for most community-level biodiversity analyses (e.g., observer names, etc.). The field `taxon_id` consists of the standard AOU 4-letter species code, although `taxon_rank` refers to eight potential levels of identification (class, family, genus, species, speciesGroup, subfamily, and subspecies). Users can decide which level is appropriate, for example one might choose to exclude all unidentified birds (taxon_id = UNBI), where no further details are available below the class level (Aves sp.). The sampling protocol has evolved over time, so users are advised to check whether the ‘samplingProtocolVersion’ associated with bird point count data (‘DP1.10003.001’) fits their data requirements and subset as necessary. Older versions of protocols can be found at the [NEON document library](https://data.neonscience.org/documents/-/document_library_display/JEygRkSpUBoq/view/1883155?_110_INSTANCE_JEygRkSpUBoq_topLink=home&_110_INSTANCE_JEygRkSpUBoq_delta1=20&_110_INSTANCE_JEygRkSpUBoq_keywords=&_110_INSTANCE_JEygRkSpUBoq_advancedSearch=false&_110_INSTANCE_JEygRkSpUBoq_andOperator=true&p_r_p_564233524_resetCur=false&_110_INSTANCE_JEygRkSpUBoq_delta2=20&_110_INSTANCE_JEygRkSpUBoq_cur2=1). 

### Ground Beetles and Herp Bycatch

**NEON Sampling Design** Ground beetle sampling is conducted via pitfall trapping, across 10 distributed plots at each NEON site. The original sampling design included the placement of a pitfall trap at each of the cardinal directions along the distributed plot boundary, for a total of four traps per plot and 40 traps per site. In 2018, sampling was reduced via the elimination of the North pitfall trap in each plot, resulting in 30 traps per site.

Beetle pitfall trapping begins when the temperature has been >4°C for 10 days in the spring and ends when temperatures dip below this threshold in the fall. Sampling occurs biweekly throughout the sampling season with no single trap being sampled more frequently than every 12 days. After collection, the samples are separated into carabid species and bycatch.
Invertebrate bycatch is pooled to the plot level and archived. Vertebrate bycatch is sorted and identified by NEON technicians, then archived at the trap level. Carabid samples are sorted and identified by NEON technicians, after which a subset of carabid individuals are sent to be pinned and re-identified by an expert taxonomist. More details can be found in @hoekman2017design.

Pitfall traps and sampling methods are designed by NEON to reduce vertebrate bycatch [@hoekman2017design]. The pitfall cup is medium in size with a low clearance cover installed over the trap entrance to minimize large vertebrate bycatch. When a live vertebrate with the ability to move on its own volition is found in a trap, the animal is released. Live but morbund vertebrates are euthanized and collected along with deceased vertebrates. When ≥15 individuals of a vertebrate species are collected, cumulatively, within a single plot, NEON may initiate localized mitigation measures such as temporarily deactivating traps and removing all traps from the site for the remainder of the season. Thus, while herpetofaunal (herp) bycatch is present in many pitfall samples it is unclear how well these pitfall traps capture herp community structure and diversity - due to these active efforts to reduce vertebrate bycatch. Users of NEON herp bycatch data should be aware of these limitations.

**Data Wrangling Decisions** The beetle and herp bycatch data product identifier is ‘DDP1.10022.001’. Carabid samples are recorded and identified in a multi-step workflow wherein a subset of samples are passed on in each successive step. Individuals are first identified by the sorting technician after which a subset is sent on to be pinned. Some especially difficult individuals are not identified by technicians during sorting, instead being labelled “other carabid”. The identifications for those individuals are recorded with the pinning data. Any individuals for which identification is still uncertain are then verified by an expert taxonomist. There are a few cases where an especially difficult identification was sent to multiple expert taxonomists and they did not agree on a final taxon, these individuals were excluded from the data set at the recommendation of NEON staff. 

Preference is given to expert identification whenever available. However, these differences in taxonomic expertise do not seem to cause systematic biases in estimating species richness across sites, but non-expert taxonomists are more likely to misidentify non-native carabid species [@egli2020taxonomic]. Beetle abundances are recorded for the sorted samples by NEON technicians. To account for individuals who were later reidentified, the final abundance for a species is the original sorting sample abundance minus the number of individuals that were given a new ID. 

Prior to 2018, `trappingDays` values were not included for many sites. Missing entries were calculated as the range from `setDate` through `collectDate` for each trap. We also accounted for a few plots for which `setDate` was not updated based on a previous collection event in the `trappingDays` calculations. To facilitate easy manipulation of data within and across bouts a new `boutID` field was created to identify all trap collection events at a site in a bout. The original `EventID` field is intended to identify a bout, but has a number of issues that necessitates creation of a new ID. First, `EventID` does not correspond to a single collection date but rather all collections in a week. This is appropriate for the small number of instances when collections for a bout happen over multiple consecutive days (~5% of bouts), but prevents analysis of bout patterns at the temporal scale of a weekday. The data here were updated so all entries for a bout correspond to the date (i.e., `collectDate`) on which the majority of traps are collected to maintain the weekday-level resolution with as high of fidelity as possible, while allowing for easy aggregation within bouts and `collectDate`’s. Second, there were a few instances in which plots within a site were set and collected on the same day, but have different `EventID`’s. These instances were all considered a single bout by our new `boutID`, which is a unique combination of `setDate`, `collectDate`, and `siteID`. 

Herpetofaunal bycatch (amphibian and reptile) in pitfall traps were identified to species or the lowest taxonomic level possible within 24 h of recovery from the field. To process the herp bycatch NEON data we cleaned `trappingDays` and the other variables and added `boutID` as described above for beetles. The variable `sampleType` in the `bet_sorting` table provides the type of animal caught in a pitfall trap as one of five types: ‘carabid’,  ‘vert bycatch herp’, ‘other carabid’, ‘invert bycatch’ and ‘vert bycatch mam’. We filtered the beetle data described above to only include the ‘carabid’ and ‘other carabid’ types. For herps, we only kept the `sampleType` of  ‘vert bycatch herp’. Abundance data of beetles and herps bycatch were standardized to be the number of individuals captured per trap day.

### Mosquitos

**NEON Sampling Design** Mosquito specimens are collected at 47 terrestrial sites across all NEON domains and the data are reported in NEON data product DP1.10043.001. Traps are distributed throughout each site according to a stratified-random spatial design used for all Terrestrial Observation System sampling, maintaining stratification across dominant (>5% of total cover) vegetation types. The number of mosquito traps placed in each vegetation type is proportional to its percent cover, until 10 total mosquito traps have been placed in the site. Mosquito traps are typically located within 30 m of a road to facilitate expedient sampling, and are placed at least 300 m apart to maintain independence.

Mosquito monitoring is divided into off-season and field season sampling. Off-season sampling begins after three consecutive zero-catch field sampling bouts have occurred, and represents a reduced sampling regime that is designed for the rapid detection of when the next field season should begin and to provide mosquito phenology data. Off-season sampling is conducted at three dedicated mosquito traps spread throughout each core site, while temperatures are >10 °C. Once per week, technicians deploy traps at dusk and then collect them at dawn the following day.

Field season sampling begins when the first mosquito is detected during off season sampling.  Technicians deploy traps at all 10 dedicated mosquito trap locations per site. Traps remain out for a 24-hour period, or sampling bout, and bouts occur every two or four weeks at core and relocatable terrestrial sites, respectively. During the sampling bout, traps are serviced twice and yield one night-active sample, collected at dawn or about eight hours after the trap was set, and one day-active sample, collected at dusk or ~16 hours after the trap was set. Thus, a 24-hour sampling bout yields 20 samples from 10 traps.

NEON collects mosquito specimens using Center for Disease Control (CDC) CO~2~ light traps. These traps have been used by other public health and mosquito-control agencies for a half-century, so that NEON mosquito data align across NEON field sites and with existing long-term data sets. A CDC CO~2~ light trap consists of a cylindrical insulated cooler that contains dry ice, a plastic rain cover attached to a battery powered light/fan assembly, and a mesh collection cup. During deployment, the dry ice sublimates and releases CO~2~. Mosquitoes attracted to the CO~2~ bait are sucked into the mesh collection cup by the battery-powered fan, where they remain alive until trap collection.

Following field collection, NEON’s field ecologists process, package, and ship the samples to an external lab where mosquitoes are identified to species and sex (when possible). A subset of identified mosquitoes are tested for infection by pathogens to quantify the presence/absence and prevalence of various arboviruses. Some mosquitoes are set aside for DNA barcode analysis as well as long-term archiving. Particularly rare or difficult to identify mosquito specimens are prioritized for DNA barcoding. More details can be found in @hoekman2016design.

**Data Wrangling Decisions** The mosquito data product (`DP1.10043.001`) consists of four data frames: trapping data (`mos_trapping`), sorting data (`mos_sorting`), archiving data (`mos_archivepooling`), and expert taxonomist processed data (`mos_expertTaxonomistIDProcessed`). We first removed rows (records) with missing information about location, collection date, and sample or subsample ID for all data frames. We then merged all four data frames into one, wherein we only kept records for target taxa (i.e., `targetTaxaPresent == "Y"`) with no known compromised sampling condition (i.e., `sampleCondition == "No known compromise"`). We further removed a small number of records with species identified only to the family level; all remaining records were identified at least to the genus level. We estimated the total individual count per trap-hour for each species within a trap as `(individualCount/subsampleWeight) * totalWeight / trapHours`. We then removed columns that were not likely to be used for calculating biodiversity values. 

### Small Mammals

**NEON Sampling Design** NEON defines small mammals based on taxonomic, behavioral, dietary, and size constraints, and includes any rodent that is (1) nonvolant; (2) nocturnally active; (3) forages predominantly aboveground; and (4) has a mass >5 grams, but <~ 500-600 grams. In North America, this includes cricetids, heteromyids, small sciurids, and introduced murids, but excludes shrews, large squirrels, rabbits, or weasels, although individuals of these species may be incidentally captured. Small mammals are collected at NEON sites using Sherman traps, identified to species in the field, marked with a unique tag, and released. Multiple 90 m $\times$ 90 m trapping grids are set up in each terrestrial field site within the dominant vegetation type. Each 90 m $\times$ 90 m trapping grid contains 100 traps placed in a pattern with 10 rows and 10 columns set 10 m apart. Three 90 m $\times$ 90 m grids per site are designated pathogen grids and the remainder are designated diversity grids. Small mammal sampling occurs in bouts, with a bout comprised of three consecutive (or nearly consecutive) nights of trapping at each pathogen grid and one night of trapping at each diversity grid. The timing of sampling occurs within 10 days before or after the new moon. The number of bouts per year is determined by site type: core sites are typically trapped for 6 bouts per year (except for areas with shorter seasons due to cold weather), while relocatable sites are trapped for 4 bouts per year.

**Data Wrangling Decisions** In the small mammal data product (`DP1.10072.001`), records are stratified by NEON site, year, month, and day and represent data from both the diversity and pathogen sampling grids. Capture records were removed if they were not identified to genus or species (e.g., if the species name was denoted as ‘either/or’ or as family name), if their trap status is not “5 - capture” or “4 - more than 1 capture in one trap”.  Abundance data for each plot and month combination were standardized to be the number of individuals captured per 100 trap nights.

### Soil Microbes

**NEON Sampling Design** Soil samples are collected at ten 40 x 40 m2 NEON plots per site. Four plots are within the tower airshed (tower plots), and six plots are distributed across the landscape (gradient plots). At each sampling time, soils are sampled from three of four subplots, and one sample is collected from a randomly-generated XY coordinate location within each subplot. At each sampling location, soils are taken at the surface horizon most years, but from both organic and mineral horizons every five years during coordinated microbe/biogeochemistry bouts. Most sites, except for the boreal/arctic sites, are sampled three times a year, once at peak vegetation greenness and two other times bracketing that period. This results in ~10 plots * 3 locations * 1 or 2 horizons * 3 periods = 90 - 180 soil samples per site per year for most sites. Samples for microbial biomass, composition, and metagenomics are stored on dry ice and shipped to an external lab (variable depending on year) for downstream processing.

**Data Wrangling Decisions** Unlike other NEON biodiversity data products, the soil microbial data product (`DP1.10107.001`) requires significant pre-processing to go from raw sequence data to a community matrix, and the exact bioinformatics methods will vary depending on use case. Briefly, major decisions during this process will depend on whether users are working with fungal (ITS) or bacterial (16S) data, if the goal is to maximize read quality and taxonomic resolution vs. number of reads retained through the quality filter process, and whether to remove or retain reverse complement reads for a merged sequence. The full description of a suggested bioinformatics pipeline, how to run sensitivity analyses on user-defined parameters, accompanying code, and vignettes are described in Qin et al. in this issue. At the end of the suggested bioinformatics pipeline, users will have a phyloseq object, which is a commonly-used format for sequence-based analysis software. The phyloseq object will contain a table of ASV (amplicon sequence variant) sequences, a table of taxonomic assignments, and soil chemical and physical data associated with corresponding sample locations and sampling bouts.

Note that NEON provides both ITS and 16S marker gene sequence data for soil, benthic, and surface water microbes in data products DP1.10108.001, DP1.20280.001, and DP1.20282.001, respectively. Based on the input from the potential data user community, NEON staff scientists have recently developed an in-house bioinformatics pipeline to produce associated derived soil, benthic, and surface water microbe community composition data products, which are published as DP1.10081.001, DP1.20086.001, and DP1.20141.001, respectively. However, at the time of writing this, the completed community composition data products have not been fully published; thus, they focus on the soil microbial marker gene sequences data product (DP1.10108.001), which has the most extensive spatial and temporal coverage for data availability out of the marker gene sequence data products. 

### Terrestrial Plants

**NEON Sampling Design** NEON plant diversity sampling is completed once or twice per year (one or two ‘bouts’) in multiscale, 20 m $\times$ 20 m (400 m^2^) plots. The multiscale plot design subdivides into four 10 m $\times$ 10 m (100 m^2^) subplots that each encompass one or two sets of 3.16 m $\times$ 3.16 m (10 m^2^) subplots within which a 1 m $\times$ 1 m (1 m^2^) subplot is nested. The cover of each species is estimated visually in the 1 m^2^ subplots. The presence of species is documented in the 10 m^2^  and 100 m^2^ subplots, when aggregated these data represent incidence of species at the 400 m^2^ plot scale. In practice in the field, cover by species is recorded in a 1 m^2^ subplot. Next, the remaining 9 m^2^ area of the associated 10 m^2^ subplot is searched for the presence of species. The process is repeated if there is a second 1 and 10 m^2^ nested pair in the specific 100 m^2^ subplot. Next, the remaining 80 m^2^ area is searched for the presence of species; data can be aggregated for a complete list of species present at the 100 m^2^ subplot scale. In most cases, species encountered in a 10 m^2^ subplot that were already documented in the nested 1 m^2^ subplot are not recorded as the 1 m^2^ subplot occupies 1 m^2^ of the associated 10 m^2^ subplot. The same is true of species reported in the 100 m^2^ subplots, only species not yet reported in the nested 1 and 10 m^2^ subplot(s) are reported. A full dataset for each NEON plant diversity plot was generated by combining all data from all subplots within the 20 m $\times$ 20 m plot, and removing duplicates (which may occur when recording and/or aggregating species presence across nested subplots within each 100 m^2^ subplot and across the four 100 m^2^ subplots). More details about the sampling design can be found in @barnett2019plant. 

NEON manages plant taxonomic entries with a master taxonomy list that is based on the community standard, where possible. Using this list, synonyms for a given species are converted to the currently used name. The master taxonomy for plants is the USDA PLANTS Database (USDA, NRCS. 2014. https://plants.usda.gov), and the portions of this database included in the NEON plant master taxonomy list are those pertaining to native and naturalized plants present within the NEON sampling area. A sublist for each NEON domain includes those species with ranges that overlap the domain as well as nativity designations - introduced or native - in that part of the range. If a species is reported at a location outside of its known range, and the record proves reliable, the master taxonomy list is updated to reflect the distribution change. For more on the NEON plant master taxonomy list see NEON.DOC.014042 (https://data.neonscience.org/api/v0/documents/NEON.DOC.014042vK).

**Data Wrangling Decisions** In the plant presence and percent cover data product (`DP1.10058.001`) sampling at the 1 m $\times$ 1 m scale also includes observations of abiotic and non-target species ground cover (i.e., soil, water, downed wood), so we removed records with `divDataType` as “otherVariables.” We also removed records whose `targetTaxaPresent` is `N` (i.e., a non-target species). Additionally, for all spatial resolutions (i.e., 1 m^2^, 10 m^2^, and 100 m^2^ data), any record lacking information critical for combining data within a plot and for a given sampling bout (i.e., `plotID`, `subplotID`, `boutNumber`, `endDate`, or `taxonID`) was dropped from the dataset. Furthermore, records without a definitive genus or species level `taxonID` (i.e., those representing unidentified morphospecies) were not included. To combine data from different spatial resolutions into one data frame, we created a pivot column entitled `sample_area_m2` (with possible values of 1, 10, and 100). Because of the nested sampling design of the plant data, to capture all records within a subplot at the 100 m^2^ scale, we incorporated all data from both the 1 m^2^ and 10 m^2^ scales for that subplot. Similarly, to obtain all records within a plot at the 400 m^2^ scale, we included all data from that plot. Species abundance information was only recorded as area coverage within 1 m by 1 m subplots; however, users may use the frequency of a species across subplots within a plot or plots within a site as a proxy of its abundance if needed.

### Ticks and Tick Pathogens

**NEON Sampling Design** Tick sampling occurs in six distributed plots at each site, which are randomly chosen in proportion to NLCD land cover class. Sampling begins on a low intensity schedule with one sampling bout every six weeks. Once >5 ticks of any life stage have been collected within the last year at that site, sampling switches to a high intensity schedule with one bout every three weeks. A site remains on the high intensity schedule until <5 ticks are collected within a year, then it reverts back to the low intensity schedule. High intensity sampling reoccurs when >5 ticks are collected within a year. Onset of sampling coincides with phenological milestones at each site, beginning within two weeks of the onset of green-up and ending within two weeks of vegetation senescence. Sampling bouts are only initiated if the high temperature on the two consecutive days prior to planned sampling was >0°C.

Ticks are sampled by walking the perimeter of a 40 m $\times$ 40 m plot using a 1 m $\times$ 1 m drag cloth. Ideally, 160 meters are sampled (shortest straight line distance between corners), but the cloth can be dragged around obstacles if a straight line is not possible. Acceptable total sampling area is between 80-180 meters. The cloth can also be flagged over vegetation when the cloth cannot be dragged across it. Ticks are collected from the cloth and technicians’ clothing at appropriate intervals depending on vegetation density and at every corner of the plot and are immediately transferred to a vial containing 95% ethanol. 

Ticks are sent to the US National Tick Collection at Georgia Southern University for identification to species, life stage, and sex. A subset of nymphal ticks are sent to the Laboratory of Medical Zoology at the University of Massachusetts Amherst for pathogen testing. _Ixodes scapularis_ are tested for _Anaplasma phagocytophilum_, _Babesia microti_, _Borrelia burgdorferi_ sensu lato, _Borrelia miyamotoi_, _Borrelia mayonii_, other _Borrelia_ species (_Borrelia_ sp.), and a _Ehrlichia_ muris-like agent [@pritt2017proposal]. _Amblyomma americanum_ was tested for _Anaplasma phagocytophilum_, _Borrelia lonestari_ (and other undefined _Borrelia_ species), _Ehrlichia chaffeensis_, _Ehrlichia ewingii_, _Francisella tularensis_, and _Rickettsia rickettsii_.  

**Data Wrangling Decisions** The tick data product (`DP1.10093.001`) consists of two dataframes: ‘tck_taxonomyProcessed’ hereafter referred to as ‘taxonomy data’ and ‘tck_fielddata’ hereafter referred to as ‘field data.’ Users should be aware of some issues related to taxonomic ID. Counts assigned to higher taxonomic levels (e.g., at the order level _Ixodida_; IXOSP2) are not the sum of lower levels; rather they represent the counts of individuals that could not reliably be assigned to a lower taxonomic unit. Samples that were not identified in the lab were assigned to the highest taxonomic level (order _Ixodida_; IXOSP2). However, users could make an informed decision to assign these ticks to the most probable group if a subset of individuals from the same sample were assigned to a lower taxonomy.

To clean the tick data, we first removed surveys and samples not meeting quality standards. In the taxonomy data, we removed samples where sample condition was not listed as “OK” (<1% of records). In the field data, we removed records where samples were not collected due to logistical concerns (10%).  We then combined male and female counts in the taxonomy table into one “adult” class. The taxonomy table was re-formatted so that every row contained a sampleID and counts for each species life-stages were separate columns (i.e., “wide format”). Next, we joined the field data to the taxonomy data, using the sample ID to link the two tables. When joining, we retained field records where no ticks were found in the field and thus there were no associated taxonomy data. In drags where ticks were not found, counts were given zeros. All counts were standardized by area sampled. 

Prior to 2019, both field surveyors and laboratory taxonomists enumerated each tick life-stage; consequently, in the joined dataset there were two sets of counts (“field counts” and “lab counts”). However, starting in 2019, counts were performed by taxonomists rather than field surveyors. Field surveys conducted after 2019 no longer have field counts. Users of tick abundance data should be aware that this change in protocol has several implications for data wrangling and for analysis. First, after 2019, tick counts are no longer published at the same time as field survey data. Subsequently, some field records from the most recent years have tick presence recorded (targetTaxaPresent = “Y”), but do not yet have associated counts or taxonomic information and so the counts are still listed as `NA`. We have added a column to designate whether counts are still pending as of this data release. Users should be aware that counts of zero are therefore published earlier than positive counts. We strongly urge users to filter data to those years where there are no counts pending. 

The second major issue is that in years where both field counts and lab counts were available, they did not always agree (8% of records). In cases of disagreement, we generally used lab counts in the final abundance data, because this is the source of all tick count data after 2019 and because life-stage identification was more accurate. However, there were a few exceptions where we used field count data. In some cases, only a subsample of a certain life-stage was counted in the lab, which resulted in higher field counts than lab counts. In this case, we assigned the additional un-identified individuals (e.g., the difference between the field and lab counts) to the order level (IXOSP2). If quality notes from NEON described ticks being lost in transit, we also added the additional lost individuals to the order level. There were some cases (<1%) where the field counts were greater than lab counts by more than 20% and where the explanation was not obvious; we removed these records.We note that the majority of samples (~85%) had no discrepancies between the lab or field, therefore this process could be ignored by users whose analyses are not sensitive to exact counts.

The tick pathogen data product (`DP1.10092.001`) consists of two dataframes: `tck_pathogen` hereafter referred to as ‘pathogen data’ and `tck_pathogenqa` hereafter referred to as ‘quality data’. First, we removed any samples that had flagged quality checks from the quality data and removed any samples that did not have a positive DNA quality check from the pathogen data. Although the original online protocol aimed to test 130 ticks per site per year from multiple tick species, the final sampling decision was to extensively sample IXOSCA, AMBAME, and AMBSP species only because IXOPAC and _Dermacentor_ nymph frequencies were too rare to generate meaningful pathogen data. _Borrelia burgdorferi_ and _Borrelia burgdorferi sensu lato_ tests were merged, since the former was an incomplete pathogen name and refers to _B. burgdorferi sensu lato_ as opposed to _sensu stricto_ [@rudenko2011updates]. Tick pathogen data are presented as positivity rate calculated as number positive tests per number of tests conducted for a given pathogen on ticks collected during a given sampling event. 

## Aquatic Organisms

### Aquatic macroinvertebrates

**NEON Sampling Design** Aquatic macroinvertebrate sampling occurs three times/year at wadeable stream, river, and lake sites from spring through fall. Samplers vary by habitat and include Surber, Hess, hand corer, modified kicknet, D-frame sweep, and petite ponar samplers. Lake sampling occurs with a petite ponar near buoy, inlet, and outlet sensors, and D-frame sweeps in littoral zones. Riverine sample collections in deep waters or near buoys are made with a petite ponar, and in littoral areas are made with a D-frame sweep or large-woody debris sampler. In the field, samples are preserved in pure ethanol, and later in the domain support facility, glycerol is added to prevent the samples from becoming brittle. Samples are shipped from the domain facility to a taxonomy lab for sorting and identification to lowest possible taxon (e.g., genus or species) and counts of each taxon per size are made to the nearest mm.     

**Data Wrangling Decisions** Aquatic macroinvertebrate data contained in the data product `DP1.20120.001` are subsampled and identified to the lowest practical taxonomic level, typically genus, by expert taxonomists in the `inv_taxonomyProcessed` table, measured to the nearest mm size class, and counted. Taxonomic naming has been standardized in the `inv_taxonomyProcessed` file, according to NEON’s master taxonomy (<https://data.neonscience.org/taxonomic-lists>), removing any synonyms. We calculated macroinvertebrate density by dividing `estimatedTotalCount` (which includes the corrections for subsampling in the taxonomy lab) by `benthicArea` from the `inv_fieldData` table to return count per square meter of stream, lake, or river bottom.

### MicroAlgae (Periphyton and Phytoplankton)

**NEON Sampling Design** Algal sampling methods vary by system (i.e., wadeable streams, rivers, lakes) and are sampled three times per year (i.e., spring, summer, and fall). In wadeable streams, which have variable habitats (e.g., riffles, runs, pools, step pools), five periphyton samples are collected in the dominant habitat type and three in the second most dominant habitat type over a 1 km reach. No two samples should come from the sample habitat unit (i.e., the same riffle). 

Periphyton samples are collected from natural surface substrata with the specific collection method and sampler type dependent on the substrate type (i.e., cobble vs. silt vs. woody debris) [see @moulton2002revised for detailed methods]. Periphyton are also collected from lakes and rivers from three areas (five from 2014-2018) in the littoral zone (i.e., shoreline) with the most dominant substratum type selected. In rivers, phytoplankton are sampled near the sensor buoy and at two other deep-water points in the main channel, using a Kemmerer sampler. For lakes, phytoplankton are collected by the central sensor buoy as well as at the two littoral sensors, using a Kemmerer sampler. For stratified lakes and non-wadeable streams, the phytoplankton sample is a composite from one surface sample, one sample from the metalimnion (i.e., middle layer), and one sample from the bottom of the euphotic zone. For non-stratified lakes and non-wadeable streams, the phytoplankton sample is a composite from one surface sample, one sample just above the bottom of the euphotic zone, and if the euphotic zone is > 5 m, then one mid-euphotic zone sample. 

Samples are processed at the domain support facility and separated into subsamples for taxonomic analysis or for biomass measurements. Aliquots shipped to an external facility for taxonomic determination are preserved in glutaraldehyde or Lugol's iodine (before 2021). Aliquots for biomass measurements are filtered onto glass-fiber filters and processed for ash-free dry mass.

**Data Wrangling Decisions** The periphyton, seston, and phytoplankton data product (`DP1.20166.001`) contains three dataframes for algae containing information on algae taxonomic identification, biomass and related field data, which are hereafter referred to as `alg_tax_long`, `alg_biomass` and `alg_field_data`. Algae within samples are identified to the lowest possible taxonomic resolution, usually species, by contracting laboratory taxonomists. Some specimens can only be identified to the genus or even class level, depending on the condition of the specimen. Ten percent of all samples are checked by a second taxonomist and are noted in the `qcTaxonomyStatus`. Taxonomic naming has been standardized in the `alg_tax_long` files, according to NEON’s master taxonomy, removing nomenclatural synonyms. Abundance and cell/colony counts are determined for each taxon of each sample with counts of cells or colonies that are either corrected for sample volume or not (as indicated by algalParameterUnit = 'cellsperBottle'). 

We corrected sample units of `cellsperBottle` to density. First, we summed the preservative volume and the lab’s recorded sample volume for each sample (from the `alg_biomass` file) and combined that with the `alg_tax_long` file using `sampleID` as a common identifier. Where samples in the `alg_tax_long` file were missing data in the `perBottleSampleVolume` field (measured after receiving samples at the external laboratory), we estimated the sample volume using NEON domain lab sample volumes (measured prior to shipping samples to the external laboratory). With this updated file, we combined it with `alg_field_data` to have the related field conditions, including benthic area sampled for each sample. `parentSampleID` was used for `alg_field_data` to join to the `alg_biomass` file’s `sampleID` as `alg_field_data` only has `parentSampleID`. We then calculated cells per milliliter for the uncorrected taxon of each sample, dividing `algalParameterValue` by the updated sample volume. Benthic sample results are expressed in terms of area (i.e., multiplied by the field sample volume, divided by benthic area sampled), in square meters. The final abundance units are either cells/mL (phytoplankton and seston samples) or cells/m^2^ for benthic samples. 

The `sampleIDs` are child records of each `parentSampleID` that will be collected as long as sampling is not impeded (i.e., ice covered or dry). In the `alg_biomass` file, there should be only a single entry for each `parentSampleID`, `sampleID`, and `analysisType`. Most often, there were two `sampleID`’s per `parentSampleID` with one for ash-free dry mass (AFDM) and taxonomy (analysis types). For the creation of the observation table with standardized counts, we used only records from the `alg_biomass` file with the `analysisType` of taxonomy. In `alg_tax_long`, there are multiple entries for each `sampleID` for each taxon by `scientificName` and `algalParameter`. 

### Fish

**NEON Sampling Design** Fish sampling is carried out across 19 of the NEON eco-climatic domains including both lotic (23 stream habitats) and lentic (five lake habitats) habitats. Each site is surveyed with two bouts per year, during the spring and fall, with a combination of random and fixed sampling areas (i.e., segments in lakes; reaches in streams) to capture spatial and temporal heterogeneity of aquatic habitats. Each sampling bout is completed within five days with a minimum two-week gap in between two successive sampling bouts. The initial sampling date is determined using site-specific historical data on ice melting, water temperature (or accumulated degree days), and riparian peak greenness. 

At each lake, 10 pie-shaped segments are established, wherein each segment ranges from the riparian zone into the lake center, therefore effectively capturing both nearshore and offshore habitats. Three of the 10 segments are fixed and are surveyed twice a year with a backpack electrofisher using a three-pass electrofishing depletion approach [@moulton2002revised; @peck2006environmental]. All three passes in a fixed sampling segment or reach are completed on the same night, with ≤30-minutes between successive passes. Electrofishing is started and ceases 30-minutes after and before sunset and sunrise, respectively, with a maximum of five passes per sampling bout. Gill nets are deployed for 1-2 hrs either in the morning or early afternoon.  Additionally, a fyke net and a gill net are deployed at each fixed segment [@baker1997environmental]. Fyke nets are positioned before sunset and recovered after sunrise on the following day. The remaining random segments are sampled on a rotation design with a single electrofishing pass, one mini-fyke net, and one gill net where three segments are surveyed twice a year. Precise start and end times for both electrofishing and net deployments are documented.

In each stream site, a maximum of 10 non-overlapping reaches (where each reach is 70-130 m in length) are designated within a 1 km stream length, and six of those reaches are sampled during any given sampling bout. The 10 reaches include three fixed reaches that are consistently sampled and seven random reaches that are sampled on rotation. The three fixed reaches encompass all representative habitats found within a 1 km stretch and are surveyed twice a year (once in each bout) using a three-pass electrofishing depletion approach [@moulton2002revised; @peck2006environmental]. The random reaches are surveyed on rotation via a single-pass depletion approach; three random reaches are sampled twice a year (once in each bout), while another three random reaches are sampled in the subsequent year. Electrofishing at streams is done during daytime.  

In all surveys, captured fish are identified to the lowest practical taxonomic level, and morphometrics (i.e., body mass and body length) are recorded for 50 individuals of each taxon before releasing. Relative abundance for each fish taxon is also recorded by direct enumeration (up to first 50 individuals) or estimation by bulk counts (>50 individuals, i.e., by placing fish of a given taxon into a dip net (i.e., net scoop), counting the total number of specimens in the dip net, and then multiplying the total number of scoops of captured fish by the counts from the first scoop). 

**Data Wrangling Decisions** Fish sampled via both electrofishing and trapping are identified at variable taxonomic resolutions (as fine as subspecies level) in the field. Most identifications are made to the species or genus level by a single field technician for a given bout per site. Sampled fish are identified, measured, weighed, and then released back to the site of capture. If field technicians are unable to identify to the species level, such specimens are identified to the finest possible taxonomic resolution or assigned a morphospecies with a coarse-resolution identification. The standard sources consulted for identification and a qualifier for identification validity are also documented in the `fsh_perFish` table. The column `bulkFishCount` of the `fsh_bulkCount` table records relative abundance for each species or the alternative next possible taxon level (specified in the column `scientificName`). 

Fish data (taxonomic identification and relative abundance) are recorded per each sampling reach in streams or per segment in lakes in each bout and documented in the `fsh_perFsh` table. The column `eventID` uniquely identifies the sampling date of the year, the specific site within the domain, a reach/segment identifier, the pass number (i.e., number of electrofishing passes or number of net deployment efforts), and the survey method. The `eventID` column helps tie all fish data with stream reach/lake segment data or environmental data (i.e., water quality data) and sampling effort data (e.g., electrofishing and net set time). A `reachID` column provided in the `fsh_perPass` table uniquely identifies surveys done per stream reach or lake segment. The `reachID` is nested within the `eventID` as well. We used `eventID` as a nominal variable to uniquely identify different sampling events and to join different, stacked fish data files as described below.

The fish data product (`DP1.20107.001`) consists of `fsh_perPass`, `fsh_fieldData`, `fsh_bulkCount`, `fsh_perFish,` and the complete taxon table for fish, for both stream and lake sites. To join all reach-scale data, we first joined the `fsh_perPass` with `fsh_fieldData`, and eliminated all bouts where sampling was untenable. Subsequently, we joined the reach-scale table with `fsh_perFsh` to add individual fish counts and fish measurements. Then, to add bulk counts, we joined the reach-scale table with `fsh_bulkCount` datasets, and subsequently added `taxonRank` which included the taxonomic resolution into the bulk-processed table. Afterward, both individual-level and bulk-processed datasets were appended into a single table. To include samples where no fish were captured, we filtered the `fsh_perPass` table retaining records where target taxa (fish) were absent, joined it with `fsh_fieldData`, and finally merged it with the table that contained both bulk-processed and individual-level data. For each finer-resolution taxon in the individual-level dataset, we considered the relative abundance as one since each row represented a single individual fish. Whenever possible, we substituted missing data by cross-referencing other data columns, omitted completely redundant data columns, and retained records with genus- and species-level taxonomic resolution. For the appended dataset, we also calculated the relative abundance for each species per sampling reach or segment at a given site. To calculate species-specific catch per unit effort (CPUE), we normalized the relative abundance by either average electrofishing time (i.e., `efTime`, `efTime2`) or trap deployment time (i.e., the difference between `netEndTime` and `netSetTime`). For trap data, we assumed that size of the traps used, water depths, number of netters used, and the reach lengths (a significant proportion of bouts had reach lengths missing) to be comparable across different sampling reaches and segments.

### Zooplankton

**NEON Sampling Design** Zooplankton samples are collected at seven NEON lake sites across four domains. Zooplankton samples are collected at the buoy sensor set (deepest location in the lake) and at the two nearshore sensor sets using a vertical tow net for locations deeper than 4 m and a Schindler trap for locations shallower than 4 m. This results in three samples collected per sampling day. Samples are preserved with ethanol in the field and shipped from the domain facility to a taxonomy lab for sorting and identification to lowest possible taxon (e.g., genus or species) and counts of each taxon per size are made to the nearest mm.    

**Data Wrangling Decisions** The NEON zooplankton data product (`DP1.20219.001`) consists of dataframes for taxonomic identification and related field data. Zooplankton in NEON samples are identified at contracting labs to the lowest possible taxonomic resolution, usually genus, however some specimens can only be identified to the family (or even class) level, depending on the condition of the specimen. Ten percent of all samples are checked by two taxonomists and are noted in the `qcTaxonomyStatus` column. The taxonomic naming has been standardized in the `zoo_taxonomyProcessed` table, according to NEON’s master taxonomy, removing any synonyms. Density was calculated using `adjCountPerBottle` and `towsTrapsVolume` to correct count data to “count per liter”.

# Results (or how to get and use tidy NEON organismal data)

All cleaned and standardized datasets can be obtained from the R package `neonDivData`, which can be installed from Github (we will submit it to CRAN in the future). Installation instructions can be found on the Github webpage (https://github.com/daijiang/neonDivData). Table \@ref(tab:dataSummary) shows the brief summary of all data objects. To get data for a specific taxonomic group, we can just call the objects in the `R object` column in Table \@ref(tab:dataSummary). Such data products include cleaned (and standardized if needed) occurrence data for the taxonomic groups covered and are equivalent to the “observation” table of the ecocomDP data format. If environmental information and species measurements were provided by NEON for some taxonomic groups, they are also included in these data objects. Information such as latitude, longitude, and elevation for all taxonomic groups were saved in the `neon_location` object of the R package, which is equivalent to the “sampling_location” table of the ecocomDP data format. Information about species scientific names of all taxonomic groups were saved in the `neon_taxa` object, which is equivalent to the “taxon” table of the ecocomDP data format. 

(ref:Table1SummaryCap) Summary of data products included in this study (as of `r format(Sys.time(), "%d %B, %Y")`). Users can call the R objects in the `R object` column from the R data package `neonDivData` to get the standardized data for specific taxonomic groups.

```{r dataSummary, echo=FALSE}
select(data_summary, Taxa = taxon_group, `R object` = r_object,
       `N species` = n_taxa, `N sites` = n_sites, `Start date` = start_date,
       `End date` = end_date) %>% 
  arrange(Taxa) %>% 
  mutate(Taxa = str_to_title(Taxa)) %>%
  knitr::kable(caption = '(ref:Table1SummaryCap)', booktab = T, 
       # align = "lrrrrrr", 
       linesep = "") %>%
 kableExtra::kable_styling(bootstrap_options = c("striped", "scale_down", "condensed", "hover"), 
              latex_options = c("striped", "scale_down"))
```

To demonstrate the use of data packages, we used `data_plant` to quickly visualize the distribution of species richness of plants across all NEON sites (Fig. \@ref(fig:Fig2Map)). To show how easy it is to get site level species richness, we presented the code used to generate the data for Fig. \@ref(fig:Fig2Map) below.

```{r eval=FALSE, echo=TRUE}
library(dplyr)
library(neonDivData)
# get species richness at each site
sp_rich_plant = data_plant %>%
  group_by(siteID) %>%
  summarise(nspp = n_distinct(taxon_id), .groups = "drop")
# get latitude and longitude of all sites
sp_rich_plant = left_join(sp_rich_plant,
                          filter(neon_location, location_id %in% data_plant$location_id) %>%
                            # each site has multiple plots with slightly different lat/long
                            group_by(siteID) %>%
                            summarise(latitude = mean(latitude),
                                      longitude = mean(longitude),
                                      .groups = "drop"),
                          by = "siteID")
```

Figure \@ref(fig:Fig2Map) shows the utility of the data package for exploring macroecological patterns. One of the most well known and studied macroecological patterns is the latitudinal biodiversity gradient, wherein sites are more speciose at lower latitudes relative to higher latitudes [@fischer1960latitudinal; @hillebrand2004generality]. Herbaceous plants of NEON generally follow this pattern, but interestingly, @read2018among found that NEON small mammal data do not support this pattern.  

(ref:Fig2MapCap) Plant species richness mapped across NEON terrestrial sites. The inset scatterplot shows latitude on the x-axis and species richness on the y-axis, with red points representing sites in Puerto Rico and Hawaii.

```{r, Fig2Map, fig.cap="(ref:Fig2MapCap)"}
include_graphics(here::here("manuscript/figures/p_plant.png"))
```

In addition to allowing for quick exploration of macroecological diversity patterns, the data packages presented in this paper also enable investigation of effects of taxonomic resolution on diversity indices since taxonomic information is preserved for observations under family level for all groups. The degree of taxonomic resolution varies for NEON taxa depending on the diversity of the group and the level of taxonomic expertise needed to identify an organism to the species level, with more diverse groups presenting a greater challenge. Beetles are one of the most diverse groups of organisms on Earth and wide-ranging geographically, making them ideal bioindicators of environmental change [@rainio2003ground]. To illustrate how the use of the beetle data package presented in this paper enables NEON data users to easily explore the effects of taxonomic resolution on community-level taxonomic diversity metrics, we calculated Jost diversity indices [@jost2006entropy] for beetles at the Oak Ridge National Laboratory (ORNL) NEON site for data subsetted at the genus, species, and subspecies level. To quantify biodiversity, we used Jost indices, which are essentially Hill Numbers that vary in how abundance is weighted with a parameter _q_. Higher values of _q_ give lower weights to low-abundance species, with _q_ = 0 being equivalent to species richness and _q_ = 1 representing the effective number of species given by the Shannon entropy. These indices are plotted as rarefaction curves, which assess the sampling efficacy. When rarefaction curves asymptote they suggest that additional sampling will not capture additional taxa. Statistical methods presented by @chao2014rarefaction provide estimates of sampling efficacy beyond the observed data (i.e., extrapolated values shown by dashed lines in Fig. \@ref(fig:Fig3Curve)). For the ORNL beetle data, Jost indices calculated with higher values of _q_ (i.e., _q_ > 0) indicated sampling has reached an asymptote in terms of capturing diversity regardless of taxonomic resolution (i.e., genus, species, subspecies). However, rarefaction curves for _q_ = 0, which is equivalent to species richness do not asymptote, even with extrapolation. These plots suggest that if a researcher is interested in low abundance, rare species, then the NEON beetle data stream at ORNL may need to mature with additional sample collections over time before confident inferences may be made, especially below the taxonomic resolution of genus.

(ref:Fig3CurveCap) Rarefaction of beetle abundance data from collections made at the Oak Ridge National Laboratory (ORNL) National Ecological Observatory Network (NEON) site from 2014-2020 generated using the beetle data package presented in this paper and the iNEXT package in R [@hsieh2016inext] based on different levels of taxonomic resolution (i.e., genus, species, subspecies). Different colors indicate Jost Indices with differing values of q [@jost2006entropy].

```{r, Fig3Curve, fig.cap="(ref:Fig3CurveCap)"}
include_graphics(here::here("manuscript/figures/beetle_rarefaction.png"))
```

# Discussion (or how to maintain and update tidy NEON organismal data)

NEON organismal data hold enormous potential to understand biodiversity change across space and time [@balch2019neon, @jones2021synergies]. Multiple biodiversity research and education programs have used NEON data even before NEON became fully operational in May 2019 [e.g., @farrell2018power; @read2018among]. With the expected long-term investment to maintain NEON over the next 30 years, NEON organismal data will be an invaluable tool for understanding and tracking biodiversity change. NEON data are unique relative to data collected by other similar networks (e.g., LTER, CZO) because observation collection protocols are standardized across sites, enabling researchers to address macroscale questions in environmental science without having to synthesize disparate data sets that differ in collection methods [@jones2021synergies]. The data package presented in this paper holds great potential in making NEON data easier to use and more comparable across studies. Whereas the data collection protocols implemented by NEON staff are standardized, the decisions NEON data users make in wrangling their data after downloading NEON’s open data will not necessarily be similar unless the user community adopts a community data standard, such as the ecocomDP data model. Adopting such a data model early on in the life of the observatory will ensure that results of studies using NEON data will be easier to compare and synthesize. By providing a standardized and easy-to-use data package of NEON organismal data, our effort here will significantly lower the barriers to use the NEON organismal data for biodiversity research by many current and future researchers and will ensure that studies using NEON organismal data are comparable.

There are some important notes about the data package we provided. First, our processes assume that NEON already did its best to make sure that species identifications are correct. Since records may be identified to any level of taxonomic resolution, and IDs above the genus level may not be useful for most biodiversity projects, we removed records with such IDs for groups that are relatively easier to identify (i.e., fish, plant, small mammals) or have very few taxon IDs that are above genus level (i.e., mosquito). However, for groups that are hard to identify (i.e., algae, beetle, bird, macroinvertebrate, tick, and tick pathogen), we decided to keep all records no matter what level of taxon IDs they have. Such information can be useful if we are interested in questions such as species-to-genus ratio or species rarefaction curves at different taxonomic levels (e.g., Fig. \@ref(fig:Fig3Curve)). Users thus need to think carefully about which level of taxon IDs they need for their research. Another note regarding species names is the term ‘sp.’ vs ‘spp.’ across NEON organismal data collections. The term ‘sp.’ refers to a single morphospecies whereas the term ‘spp.’ refers to more than one morphospecies. This is an important point to consider for community ecology biodiversity analyses because it may add uncertainty into estimates of biodiversity metrics such as species richness. Second, we kept records without any observed species/individuals in some taxonomic groups (i.e., beetle, bird, small mammal), thus preserving “true zeroes”. Such empty records provide critical information about sampling efforts. For example, if two sites both have the same number of small mammals during the same time period, however, one site has many more empty records (traps), then we can infer that the abundances of small mammals are lower than the other site. If such information is not needed in a project, then they can be removed. Third, for algae, birds, and beetles, we added standardized measurements as density (algae) and number of fish caught per hour or number of beetles caught per trap night in the data package. And finally, there are other organismal groups (Aquatic Microbes and Aquatic Plants; soil microbes are covered in Qin et al. in this issue) not included in this study given the complexity of the data.   

All code for the Data Wrangling Decisions are available within the R package `ecocomDP` (Github and Zenodo, https://github.com/EDIorg/ecocomDP). Users can modify the code if they need to make different decisions during the data wrangling process and correct any mistakes in our code by submitting a pull request to our Github repository. If researchers wish to generate their own derived organismal data sets from NEON data with slightly different decisions than the ones outlined in this paper, we recommend that they use the ecocomDP framework, contribute their workflow to the ecocomDP R package, upload the data to the EDI repository, and cite their data with the discoverable DOI given to them by EDI. Note that the ecocomDP data model was intended for community ecology analyses and may not be well suited for population-level analyses. 

Because `ecocomDP` is an R package to host code to harmonize different datasets following the ecocomDP format, we developed an R data package `neonDivData` to host and distribute the standardized NEON organismal data derived from `ecocomDP`. A separate dedicated data package has several advantages. First, it is easier and readily to use and saves time for users to run the code in `ecocomDP` to download and standardize NEON data products. Second, it is also easy to update the data package when new raw data products are uploaded by NEON to their data portal; and the updating process does not require any change in the `ecocomDP` package. This is ideal because `ecocomDP` harmonizes many different datasets besides NEON data. Third, the [Github repository page of `neonDivData`]((https://github.com/daijiang/neonDivData)) can serve as a discussion forum for researchers regarding the NEON data products without competing for attention in the `ecocomDP` Github repository page. By opening issues on the Github repository, users can discuss and contribute to improve our workflow of standardizing NEON data products. Users can also discuss whether there are other data models that the NEON user community should adopt at the inception of the observatory. As the observatory moves forward, this is an important discussion for the NEON user community and NEON technical working groups to promote synthesis of NEON data with data from other efforts (e.g., LTER, CZO, Ameriflux, the International LTER, National Phenology Network, Long Term Agricultural Research Network).

The derived data products presented here collectively represent hundreds of hours of work by members of our team - a group that met at the NEON Science Summit in 2019 in Boulder, Colorado and consisting of researchers and NEON science staff. Just as it is helpful when working with a dataset to either have collected the data or be in close correspondence with the person who collected the data, final processing decisions were greatly informed by conversations with NEON science staff and the NEON user community. Future opportunities that encourage collaborations between NEON science staff and the NEON user community will be essential to achieve the full potential of the observatory data. 

# Conclusion 

Macrosystems ecology [sensu @heffernan2014macrosystems] is at the start of an exciting new chapter with the decades long awaited buildout of NEON completed and standardized data streams from all sites in the observatory becoming publicly available online. As the research community embarks on discovering new scientific insights from NEON data, it is important that we strive to make our analyses and all derived data as reproducible as possible to ensure that connections across studies will be possible. Harmonized data sets will help in this endeavour because they naturally promote the collection of provenance as data are collated into derived products [O’Brien et al. In review, @reichman2011challenges]. Harmonized data also make synthesis easier because efforts to clean and format data leading up to analyses do not have to be repeatedly performed by individual researchers (O’ Brien et al. In review). The data standardizing processes and derived data package presented here illustrate a potential path forward in achieving a reproducible framework for data derived from NEON organismal data for ecological analyses. This derived data package also highlights the value of collaboration between the NEON user community and NEON staff for advancing NEON-enabled science.

# Acknowledgement 

This work is a result of participating in the first NEON Science Summit in 2019 and an internship program through the St. Edward's Institute for Interdisciplinary Science (i4) funded through a National Science Foundation award under Grant No. 1832282. The authors acknowledge support from the NSF Award #1906144 to attend the 2019 NEON Science Summit. Additionally, the authors acknowledge support from the NSF DEB 1926568 to S.R. and NSF DEB 1926567 to P.L.Z. Comments from NEON staff (Katie LeVan, Dylan Mpnahan, Sata Paull, Dave Barnett, Sam Simkin) and Tad Dallas greatly improved this work. The National Ecological Observatory Network is a program sponsored by the National Science Foundation and operated under cooperative agreement by Battelle Memorial Institute. This material is based in part upon work supported by the National Science Foundation through the NEON Program.


# Reference
